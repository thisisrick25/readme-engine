#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Prevent committing dist folder

# Check if this is a merge commit (git rev-parse --verify HEAD^2 >/dev/null 2>&1)
# If it's a merge commit, allow it to pass (as dist changes might come from a pull/merge)
if git rev-parse --verify HEAD^2 >/dev/null 2>&1; then
  exit 0 # Allow merge commits
fi

# Check if any files in the dist directory are staged for commit
if git diff --cached --name-only | grep -q '^dist/'; then
  echo "Error: Committing 'dist' folder is not allowed. It is managed by the release workflow."
  echo "Please unstage 'dist' files before committing."
  exit 1
fi